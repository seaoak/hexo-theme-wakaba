<!doctype html>
<html lang="{{config.language}}">
<head>
    <meta charset="utf-8">
    <title>{{config.title}}</title>
    <!--
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    -->
    <link rel="stylesheet" href="/wakaba.css" />

    {{#each theme.font.stylesheets}}
    {{#if this}}
    <link rel="stylesheet" href="{{this}}" />
    {{/if}}
    {{/each}}

</head>
<body class="hexo hexo-index">
  <div id="container">
  <header id="global_header">
    <h1><a href="./">{{config.title}}</a></h1>
    <p>{{config.subtitle}}</p>
  </header>
  <main>
    <div>
      {{!-- ================================================== --}}
      {{#*inline "article"}}
      <article>
        <header>
          <h1><a href="/{{{this.path}}}">{{this.title}}</a></h1>
          <div>
            <span class="post_date">{{this.date}}</span>
            {{#if this.updated}}
            <span class="post_updated">(updated: {{this.updated}})</span>
            {{/if}}
          </div>
          {{#if this.description}}
          <p class="post_description">{{this.description}}</p>
          {{/if}}
        </header>
        {{#if this.content}}
        <div class="post_content">{{{this.content}}}</div>
        {{/if}}
        <footer>
          {{#if this.categories}}
          {{#if this.categories.length}}
          <ul class="post_categories">
            {{#each this.categories}}
            {{#each this}}
            <li>Category: {{this}}</li>  
            {{/each}}
            {{/each}}
          </ul>
          {{else}}
          <p>Category: ---</p>
          {{/if}}
          {{/if}}
          {{!--
          {{#if this.tags}}
          <ul class="post_tags">
            {{#each this.tags}}
            <li>Tag: {{this}}</li>
            {{/each}}
          </ul>
          {{/if}}
          --}}
        </footer>
      </article>
      {{/inline}}
      {{!-- ================================================== --}}
      {{#*inline "banner"}}
      <li class="banner">
        <h3><a href="/{{{this.path}}}">{{this.title}}</a></h3>
        <p>
          <span class="post_date">{{this.date}}</span>
          {{#if this.updated}}
          <span class="post_updated">(updated: {{this.updated}})</span>
          {{/if}}
        </p>
        {{!-- TODO: How about categories/tags? --}}
      </li>
      {{/inline}}
      {{#*inline "indexPage"}}
      <article>
        <header>
          <h1><a href="./">{{> @partial-block}}</a></h1>
        </header>
        <ol class="banner_list">
          {{#each page.posts}}
          {{#each this}}
          {{> banner}}
          {{/each}}
          {{/each}}
        </ol>
      </article>
      <div class="index_pagenation">
        <p>{{#if page.prev}}<a href="/{{{page.prev.path}}}">Previous</a>{{/if}}</p>
        <p><a href="/">Home</a></p>
        <p>{{#if page.next}}<a href="/{{{page.next.path}}}">Next</a>{{/if}}</p>
      </div>
      {{/inline}}
      {{!-- ================================================== --}}
      {{#if page.posts}}{{#if page.archive}}{{else}}{{#if page.category}}{{else}}{{#if page.tag}}{{else}}
      {{#each page.posts}}
      {{#each this}}
      {{log this.tags.length}}
      {{> article}}
      {{/each}}
      {{/each}}
      {{/if}}{{/if}}{{/if}}{{/if}}
      {{!-- ================================================== --}}
      {{#if page.permalink}}
      {{#with page}}
      {{> article}}
      {{/with}}
      <div class="post_pagenation">
        <p>{{#if page.prev}}<a href="/{{{page.prev.path}}}">{{page.prev.title}}</a>{{/if}}</p>
        <p><a href="/">Home</a></p>
        <p>{{#if page.next}}<a href="/{{{page.next.path}}}">{{page.next.title}}</a>{{/if}}</p>
      </div>
      {{/if}}
      {{!-- ================================================== --}}
      {{#if page.posts}}{{#if page.archive}}
      {{#> indexPage}}Archives{{/indexPage}}
      {{/if}}{{/if}}
      {{!-- ================================================== --}}
      {{#if page.posts}}{{#if page.tag}}
      {{#> indexPage}}Tag: {{page.tag}}{{/indexPage}}
      {{/if}}{{/if}}
      {{!-- ================================================== --}}
      {{#if page.posts}}{{#if page.category}}
      {{#> indexPage}}Category: {{page.category}}{{/indexPage}}
      {{/if}}{{/if}}
      {{!-- ================================================== --}}
    </div>
  </main>
  <aside id="sidebar">
    {{#each theme.sidebar.widgets}}
    {{#if this}}
    <section>
      <h5>{{this}}</h5>
      <p>Not implemented yet.</p>
    </section>
    {{/if}}
    {{/each}}
  </aside>
  </div><!-- id="container" -->
  <nav id="global_nav">
    <ul>
      {{#each theme.nav}}
      {{#if this}}
      <li class="{{this.icon}}"><a href="{{{this.path}}}">{{this.title}}</a></li>
      {{/if}}
      {{/each}}
    </ul>
  </nav>
  <footer id="global_footer">
    <p class="copyright">Copyright (C) 2017, {{config.author}}</p>
  </footer>
</body></html>
